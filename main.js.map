{"version":3,"file":"main.js","mappings":";;;;;;;AAAA,2C;;;;;;ACAA,yC;;;;;;;;;;ACAA,wCAAwC;AACxC,wCAA8C;AAC9C,gDAAiD;AACjD,6CAA2C;AAC3C,0CAAkD;AAClD,6CAAgD;AAChD,iDAAyD;AACzD,kDAA4D;AAC5D,+CAAmD;AACnD,oDAAkE;AAClE,+CAAmD;AACnD,gDAAsD;AACtD,8CAAgD;AA4BzC,IAAM,SAAS,GAAf,MAAM,SAAS;CAAI;AAAb,8BAAS;oBAAT,SAAS;IA1BrB,mBAAM,EAAC;QACN,OAAO,EAAE;YACP,yBAAc,CAAC,YAAY,CAAC;gBAC1B,UAAU,EAAE,GAAG,EAAE,CAAC,CAAC;oBACjB,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;oBACnC,gBAAgB,EAAE,KAAK;oBACvB,eAAe,EAAE,KAAK;oBACtB,MAAM,EAAE,CAAC;iBACV,CAAC;aACH,CAAC;YACF,qBAAY,CAAC,OAAO,CAAC;gBACnB,QAAQ,EAAE,IAAI;gBACd,WAAW,EAAE,GAAG,OAAO,CAAC,GAAG,EAAE,OAAO;aACrC,CAAC;YACF,wBAAU;YACV,8BAAa;YACb,gCAAc;YACd,0BAAW;YACX,oCAAgB;YAChB,0BAAW;YACX,4BAAY;YACZ,wBAAU;SACX;QACD,WAAW,EAAE,CAAC,8BAAa,CAAC;QAC5B,SAAS,EAAE,CAAC,wBAAU,CAAC;KACxB,CAAC;GACW,SAAS,CAAI;;;;;;;ACxC1B,kC;;;;;;ACAA,2C;;;;;;;;;;;ACAA,wCAAiD;AACjD,6CAA2C;AAGpC,IAAM,aAAa,GAAnB,MAAM,aAAa;IACxB,YAA6B,UAAsB;QAAtB,eAAU,GAAV,UAAU,CAAY;IAAI,CAAC;IAGxD,OAAO;QACL,OAAO,cAAc,CAAC;IACxB,CAAC;CACF;AAPY,sCAAa;AAIxB;IADC,gBAAG,EAAC,EAAE,CAAC;;;;4CAGP;wBANU,aAAa;IADzB,uBAAU,GAAE;iEAE8B,wBAAU,oBAAV,wBAAU;GADxC,aAAa,CAOzB;;;;;;;;;;;ACXD,wCAA4C;AAGrC,IAAM,UAAU,GAAhB,MAAM,UAAU;IACrB,OAAO;QACL,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;IAClC,CAAC;CACF;AAJY,gCAAU;qBAAV,UAAU;IADtB,uBAAU,GAAE;GACA,UAAU,CAItB;;;;;;;ACPD,6C;;;;;;;;;;ACAA,wCAAwC;AACxC,+CAA6C;AAC7C,kDAAmD;AACnD,+CAAoD;AACpD,2CAAkD;AAClD,sCAAwC;AACxC,+CAA6C;AAC7C,wCAA6D;AAyBtD,IAAM,UAAU,GAAhB,MAAM,UAAU;CAAI;AAAd,gCAAU;qBAAV,UAAU;IAvBtB,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,0BAAW;YACX,yBAAc;YACd,eAAS,CAAC,aAAa,CAAC;gBACpB,OAAO,EAAE,CAAC,qBAAY,CAAC;gBACvB,UAAU,EAAE,KAAK,EAAE,aAA4B,EAAE,EAAE;oBAC/C,MAAM,MAAM,GAAG,aAAa,CAAC,GAAG,CAAS,YAAY,CAAC,CAAC;oBACvD,IAAI,CAAC,MAAM,EAAE,CAAC;wBACV,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;oBACjD,CAAC;oBACD,OAAO;wBACH,MAAM,EAAE,MAAM;wBACd,WAAW,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE;qBACpC,CAAC;gBACN,CAAC;gBACD,MAAM,EAAE,CAAC,sBAAa,CAAC;aAC1B,CAAC;SACL;QACD,WAAW,EAAE,CAAC,gCAAc,CAAC;QAC7B,SAAS,EAAE,CAAC,0BAAW,EAAE,0BAAW,CAAC;QACrC,OAAO,EAAE,CAAC,0BAAW,CAAC;KACzB,CAAC;GACW,UAAU,CAAI;;;;;;;;;;;;AChC3B,wCAA4C;AAC5C,sCAAyC;AACzC,0CAA+C;AAC/C,2CAAwC;AACxC,8CAAkE;AAClE,6DAAiC;AAG1B,IAAM,WAAW,GAAjB,MAAM,WAAW;IACpB,YACoC,SAA8B,EACtD,UAAsB;QADE,cAAS,GAAT,SAAS,CAAqB;QACtD,eAAU,GAAV,UAAU,CAAY;IAC9B,CAAC;IAEL,KAAK,CAAC,YAAY,CAAC,KAAa,EAAE,IAAY;QAC1C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QAC5D,IAAI,IAAI,IAAI,CAAC,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC;YAC1D,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,EAAE,GAAG,IAAI,CAAC;YACzC,OAAO,MAA8D,CAAC;QAC1E,CAAC;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,KAAK,CAAC,KAAK,CAAC,IAAmE;QAC3E,MAAM,OAAO,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC;QACtE,OAAO;YACH,YAAY,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC;SAC9C,CAAC;IACN,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,KAAa,EAAE,IAAY;QACtC,MAAM,YAAY,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QACjD,MAAM,WAAW,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC;QAChE,OAAO,WAAW,CAAC,IAAI,EAAE,CAAC;IAC9B,CAAC;CACJ;AA3BY,kCAAW;sBAAX,WAAW;IADvB,uBAAU,GAAE;IAGJ,6CAAW,EAAC,kBAAI,CAAC,IAAI,CAAC;iEAAoB,gBAAK,oBAAL,gBAAK,oDAC5B,gBAAU,oBAAV,gBAAU;GAHzB,WAAW,CA2BvB;;;;;;;ACnCD,wC;;;;;;ACAA,qC;;;;;;;;;;ACAA,0CAA+D;AAK/D,IAAY,QAGX;AAHD,WAAY,QAAQ;IAChB,2BAAe;IACf,yBAAa;AACjB,CAAC,EAHW,QAAQ,wBAAR,QAAQ,QAGnB;AAGM,IAAM,IAAI,GAAV,MAAM,IAAI;CAYhB;AAZY,oBAAI;AAEb;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;;mCACxB;AAGf;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;0CACH;AAGtB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,IAAI,EAAE,CAAC;;kCACjD;AAGhB;IADC,mBAAI,GAAE;;wCACa;eAXX,IAAI;IADhB,qBAAM,EAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;GAChB,IAAI,CAYhB;AAEY,kBAAU,GAAG,wBAAa,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;;;;;;;ACzB7D,mC;;;;;;;;;;;ACAA,wCAA4E;AAC5E,+CAA6C;AAC7C,4CAA2C;AAC3C,+CAAiD;AAG1C,IAAM,cAAc,GAApB,MAAM,cAAc;IACvB,YAAoB,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;IAAI,CAAC;IAG3C,KAAD,CAAC,KAAK,CAAS,IAAc;QAC9B,sDAAsD;QACtD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC5E,IAAI,CAAC,IAAI,EAAE,CAAC;YACR,OAAO,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC;QAC9C,CAAC;QACD,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACxC,CAAC;IAGK,KAAD,CAAC,QAAQ,CAAS,IAAiB;QACpC,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;IAChE,CAAC;CACJ;AAjBY,wCAAc;AAIjB;IADL,iBAAI,EAAC,OAAO,CAAC;IACD,oCAAI,GAAE;;iEAAO,oBAAQ,oBAAR,oBAAQ;;2CAOjC;AAGK;IADL,iBAAI,EAAC,UAAU,CAAC;IACD,oCAAI,GAAE;;iEAAO,0BAAW,oBAAX,0BAAW;;8CAEvC;yBAhBQ,cAAc;IAD1B,uBAAU,EAAC,MAAM,CAAC;iEAEkB,0BAAW,oBAAX,0BAAW;GADnC,cAAc,CAiB1B;;;;;;;;;;;ACvBD,kDAAgE;AAEhE,MAAa,QAAQ;CAQpB;AARD,4BAQC;AALC;IAFC,6BAAO,EAAC,EAAE,EAAE,EAAE,OAAO,EAAE,sBAAsB,EAAE,CAAC;IAChD,gCAAU,GAAE;;uCACE;AAIf;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;0CACK;;;;;;;ACTpB,4C;;;;;;;;;;ACAA,kDAA2E;AAE3E,MAAa,WAAW;CASvB;AATD,kCASC;AANC;IAFC,6BAAO,EAAC,EAAE,EAAE,EAAE,OAAO,EAAE,sBAAsB,EAAE,CAAC;IAChD,gCAAU,GAAE;;0CACE;AAKf;IAHC,8BAAQ,GAAE;IACV,gCAAU,GAAE;IACZ,+BAAS,EAAC,CAAC,EAAE,EAAE,OAAO,EAAE,6CAA6C,EAAE,CAAC;;6CACvD;;;;;;;;;;;ACVpB,wCAAwC;AACxC,0CAAkD;AAClD,8CAAyD;AAUlD,IAAM,WAAW,GAAjB,MAAM,WAAW;CAAI;AAAf,kCAAW;sBAAX,WAAW;IARvB,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,yBAAc,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,EAAE,kBAAI,CAAC,IAAI,EAAE,MAAM,EAAE,wBAAU,EAAE,CAAC,CAAC;SACvE;QACD,WAAW,EAAE,EAAE;QACf,SAAS,EAAE,EAAE;QACb,OAAO,EAAE,CAAC,yBAAc,CAAC;KAC5B,CAAC;GACW,WAAW,CAAI;;;;;;;ACZ5B,6C;;;;;;;;;;;ACAA,+CAAoD;AACpD,2CAAoD;AACpD,wCAA4C;AAC5C,wCAA+C;AASxC,IAAM,WAAW,GAAjB,MAAM,WAAY,SAAQ,+BAAgB,EAAC,uBAAQ,CAAC;IACvD,YAAY,aAA4B;QACpC,MAAM,MAAM,GAAG,aAAa,CAAC,GAAG,CAAS,YAAY,CAAC,CAAC;QACvD,IAAI,CAAC,MAAM,EAAE,CAAC;YACV,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;QACjD,CAAC;QACD,KAAK,CAAC;YACF,cAAc,EAAE,yBAAU,CAAC,2BAA2B,EAAE;YACxD,gBAAgB,EAAE,KAAK;YACvB,WAAW,EAAE,MAAM;SACtB,CAAC,CAAC;IACP,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,OAAmB;QAC9B,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,EAAE,CAAC;IAC7E,CAAC;CACJ;AAhBY,kCAAW;sBAAX,WAAW;IADvB,uBAAU,GAAE;iEAEkB,sBAAa,oBAAb,sBAAa;GAD/B,WAAW,CAgBvB;;;;;;;AC5BD,yC;;;;;;;;;;ACAA,wCAAwC;AACxC,0CAAkD;AAClD,+CAA4D;AAC5D,qDAA8E;AAC9E,kDAAmD;AACnD,qDAAyD;AAYlD,IAAM,aAAa,GAAnB,MAAM,aAAa;CAAI;AAAjB,sCAAa;wBAAb,aAAa;IAVzB,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,yBAAc,CAAC,UAAU,CAAC;gBACtB,EAAE,IAAI,EAAE,oBAAK,CAAC,IAAI,EAAE,MAAM,EAAE,0BAAW,EAAE;gBACzC,EAAE,IAAI,EAAE,gCAAW,CAAC,IAAI,EAAE,MAAM,EAAE,sCAAiB,EAAE;aACxD,CAAC;SACL;QACD,WAAW,EAAE,CAAC,sCAAiB,CAAC;QAChC,SAAS,EAAE,CAAC,gCAAc,CAAC;KAC9B,CAAC;GACW,aAAa,CAAI;;;;;;;;;;;ACjB9B,0CAA+D;AAMxD,IAAM,KAAK,GAAX,MAAM,KAAK;CAYjB;AAZY,sBAAK;AAEd;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;mCACX;AAGd;IADC,mBAAI,GAAE;;sCACU;AAGjB;IADC,mBAAI,EAAC,EAAE,IAAI,EAAE,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC;;qCACpB;AAGlB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;uCACP;gBAXT,KAAK;IADjB,qBAAM,EAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;GAChB,KAAK,CAYjB;AAEY,mBAAW,GAAG,wBAAa,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;;;;;;;;;;;;ACpB/D,0CAA+D;AAC/D,2CAAmD;AACnD,8CAAuD;AACvD,+CAAuC;AAIvC,IAAY,iBAIX;AAJD,WAAY,iBAAiB;IACzB,wCAAmB;IACnB,4CAAuB;IACvB,4CAAuB;AAC3B,CAAC,EAJW,iBAAiB,iCAAjB,iBAAiB,QAI5B;AAGM,IAAM,WAAW,GAAjB,MAAM,WAAW;CAevB;AAfY,kCAAW;AAEpB;IADC,mBAAI,EAAC,EAAE,IAAI,EAAE,gBAAK,CAAC,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;0DACrD,kBAAI,oBAAJ,kBAAI;yCAAC;AAGZ;IADC,mBAAI,EAAC,EAAE,IAAI,EAAE,gBAAK,CAAC,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;0DACrD,oBAAK,oBAAL,oBAAK;0CAAC;AAGd;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;0DACb,IAAI,oBAAJ,IAAI;8CAAC;AAGjB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;0DACf,IAAI,oBAAJ,IAAI;4CAAC;AAGf;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,iBAAiB,EAAE,OAAO,EAAE,iBAAiB,CAAC,OAAO,EAAE,CAAC;;2CAC3D;sBAdlB,WAAW;IADvB,qBAAM,EAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;GAChB,WAAW,CAevB;AAEY,yBAAiB,GAAG,wBAAa,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;;;;;;;;;;;;AC/B3E,wCAA4C;AAC5C,0CAA+C;AAC/C,2CAAiC;AACjC,+CAA8D;AAC9D,qDAAgF;AAKzE,IAAM,cAAc,GAApB,MAAM,cAAc;IACvB,YACqC,UAAgC,EAC1B,gBAA4C;QADlD,eAAU,GAAV,UAAU,CAAsB;QAC1B,qBAAgB,GAAhB,gBAAgB,CAA4B;IACnF,CAAC;IAEL,KAAK,CAAC,WAAW,CAAC,cAA8B;QAC5C,MAAM,YAAY,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QACzD,OAAO,YAAY,CAAC,IAAI,EAAE,CAAC;IAC/B,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,IAAI,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE;QACpC,MAAM,SAAS,GAAG,GAAG,CAAC;QACtB,IAAI,KAAK,GAAG,SAAS,EAAE,CAAC;YACpB,KAAK,GAAG,SAAS,CAAC;QACtB,CAAC;QACD,MAAM,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QAChC,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;IACjE,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,oBAA0C;QAC9D,MAAM,kBAAkB,GAAG,IAAI,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;QAC3E,OAAO,kBAAkB,CAAC,IAAI,EAAE,CAAC;IACrC,CAAC;IAED,KAAK,CAAC,mBAAmB,CAAC,IAAI,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE;QAC1C,MAAM,SAAS,GAAG,GAAG,CAAC;QACtB,IAAI,KAAK,GAAG,SAAS,EAAE,CAAC;YACpB,KAAK,GAAG,SAAS,CAAC;QACtB,CAAC;QACD,MAAM,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QAChC,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,QAAQ,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;IACxI,CAAC;CACJ;AAjCY,wCAAc;yBAAd,cAAc;IAD1B,uBAAU,GAAE;IAGJ,6CAAW,EAAC,oBAAK,CAAC,IAAI,CAAC;IACvB,6CAAW,EAAC,gCAAW,CAAC,IAAI,CAAC;iEADe,gBAAK,oBAAL,gBAAK,oDACO,gBAAK,oBAAL,gBAAK;GAHzD,cAAc,CAiC1B;;;;;;;;;;;;AC1CD,wCAA+G;AAC/G,kDAAmD;AAEnD,mDAAwD;AACxD,yDAAoE;AAG7D,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;IAC1B,YAA6B,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;IAAI,CAAC;IAIhE,uDADuD;IACvD,WAAW,CAAS,cAA8B;QAC9C,OAAO,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;IAC3D,CAAC;IAGD,aAAa,CAC6C,IAAY,EACV,KAAa;QAErE,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IAC1D,CAAC;IAID,+BAD+B;IAC/B,iBAAiB,CAAS,oBAA0C;QAChE,OAAO,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,CAAC;IACvE,CAAC;IAGD,mBAAmB,CACuC,IAAY,EACV,KAAa;QAErE,OAAO,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IAChE,CAAC;CACJ;AA9BY,8CAAiB;AAK1B;IAFC,iBAAI,EAAC,QAAQ,CAAC;IACf,uDAAuD;;IAC1C,oCAAI,GAAE;;iEAAiB,iCAAc,oBAAd,iCAAc;;oDAEjD;AAGD;IADC,gBAAG,EAAC,QAAQ,CAAC;IAET,qCAAK,EAAC,MAAM,EAAE,IAAI,yBAAgB,CAAC,CAAC,CAAC,EAAE,qBAAY,CAAC;IACpD,qCAAK,EAAC,OAAO,EAAE,IAAI,yBAAgB,CAAC,EAAE,CAAC,EAAE,qBAAY,CAAC;;;;sDAG1D;AAID;IAFC,iBAAI,EAAC,cAAc,CAAC;IACrB,+BAA+B;;IACZ,oCAAI,GAAE;;iEAAuB,6CAAoB,oBAApB,6CAAoB;;0DAEnE;AAGD;IADC,gBAAG,EAAC,cAAc,CAAC;IAEf,qCAAK,EAAC,MAAM,EAAE,IAAI,yBAAgB,CAAC,CAAC,CAAC,EAAE,qBAAY,CAAC;IACpD,qCAAK,EAAC,OAAO,EAAE,IAAI,yBAAgB,CAAC,EAAE,CAAC,EAAE,qBAAY,CAAC;;;;4DAG1D;4BA7BQ,iBAAiB;IAD7B,uBAAU,EAAC,SAAS,CAAC;iEAE2B,gCAAc,oBAAd,gCAAc;GADlD,iBAAiB,CA8B7B;;;;;;;;;;;ACrCD,kDAAsF;AAEtF,MAAa,cAAc;CAiB1B;AAjBD,wCAiBC;AAdC;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;4CACC;AAId;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;+CACI;AAKjB;IAHC,6BAAO,GAAE;IACT,8BAAQ,EAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IACxB,gCAAU,GAAE;;8CACK;AAIlB;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;gDACK;;;;;;;;;;;;AClBpB,kDAAyF;AACzF,qDAAkE;AAElE,MAAa,oBAAoB;CAoBhC;AApBD,oDAoBC;AAjBC;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;kDACC;AAId;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;mDACE;AAIf;IAFC,kCAAY,GAAE;IACd,gCAAU,GAAE;;uDACM;AAInB;IAFC,kCAAY,GAAE;IACd,gCAAU,GAAE;;qDACI;AAIjB;IAFC,4BAAM,EAAC,sCAAiB,CAAC;IACzB,gCAAU,GAAE;0DACJ,sCAAiB,oBAAjB,sCAAiB;oDAAC;;;;;;;;;;;ACtB7B,wCAAwC;AACxC,kDAAiD;AACjD,mDAAqD;AACrD,wCAA+C;AAexC,IAAM,cAAc,GAApB,MAAM,cAAc;CAAI;AAAlB,wCAAc;yBAAd,cAAc;IAd1B,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,gCAAc,CAAC,YAAY,CAAC;gBACxB,6DAA6D;gBAC7D,MAAM,EAAE,CAAC,sBAAa,CAAC;gBACvB,kDAAkD;gBAClD,UAAU,EAAE,CAAC,MAAqB,EAAE,EAAE,CAAC,CAAC;oBACpC,KAAK,EAAE,MAAM,CAAC,GAAG,CAAS,gBAAgB,CAAC,IAAI,EAAE;iBACpD,CAAC;aACL,CAAC;SACL;QACD,WAAW,EAAE,EAAE;QACf,SAAS,EAAE,CAAC,kCAAe,CAAC;KAC/B,CAAC;GACW,cAAc,CAAI;;;;;;;AClB/B,4C;;;;;;;;;;;ACAA,wCAA4C;AAC5C,2CAA6C;AAC7C,kDAA2D;AAIpD,IAAM,eAAe,GAArB,MAAM,eAAe;IACxB,YAAiC,GAAsB;QAAtB,QAAG,GAAH,GAAG,CAAmB;IAAI,CAAC;IAGtD,KAAD,CAAC,KAAK,CAAC,GAAY;QACpB,MAAM,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IAC/B,CAAC;CACJ;AAPY,0CAAe;AAIlB;IADL,2BAAK,GAAE;;iEACS,kBAAO,oBAAP,kBAAO;;4CAEvB;0BANQ,eAAe;IAF3B,4BAAM,GAAE;IACR,uBAAU,GAAE;IAEI,kDAAS,GAAE;iEAAc,mBAAQ,oBAAR,mBAAQ;GADrC,eAAe,CAO3B;;;;;;;ACbD,qC;;;;;;;;;;ACAA,wCAAwC;AACxC,0CAAkD;AAClD,wDAA+D;AAC/D,qDAAyD;AACzD,mDAAwE;AASjE,IAAM,gBAAgB,GAAtB,MAAM,gBAAgB;CAAI;AAApB,4CAAgB;2BAAhB,gBAAgB;IAP5B,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,yBAAc,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,EAAE,4BAAS,CAAC,IAAI,EAAE,MAAM,EAAE,kCAAe,EAAE,CAAC,CAAC;SACjF;QACD,WAAW,EAAE,CAAC,4CAAoB,CAAC;QACnC,SAAS,EAAE,CAAC,sCAAiB,CAAC;KACjC,CAAC;GACW,gBAAgB,CAAI;;;;;;;;;;;;ACbjC,wCAAoG;AACpG,qDAAyD;AAGlD,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAC7B,YAA6B,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;IAAI,CAAC;IAGhE,KAAD,CAAC,OAAO,CAC6C,IAAY,EACV,KAAa;QAErE,OAAO,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;IACvD,CAAC;IAGD,MAAM;QACF,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;IAC3C,CAAC;IAGK,KAAD,CAAC,IAAI;QACN,MAAM,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;QACpC,OAAO,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC;IAC9C,CAAC;CACJ;AArBY,oDAAoB;AAIvB;IADL,gBAAG,GAAE;IAED,qCAAK,EAAC,MAAM,EAAE,IAAI,yBAAgB,CAAC,CAAC,CAAC,EAAE,qBAAY,CAAC;IACpD,qCAAK,EAAC,OAAO,EAAE,IAAI,yBAAgB,CAAC,EAAE,CAAC,EAAE,qBAAY,CAAC;;;;mDAG1D;AAGD;IADC,gBAAG,EAAC,KAAK,CAAC;;;;kDAGV;AAGK;IADL,iBAAI,EAAC,MAAM,CAAC;;;;gDAIZ;+BApBQ,oBAAoB;IADhC,uBAAU,EAAC,YAAY,CAAC;iEAE2B,sCAAiB,oBAAjB,sCAAiB;GADxD,oBAAoB,CAqBhC;;;;;;;;;;;;ACzBD,wCAA4C;AAC5C,0CAA+C;AAC/C,2CAAiC;AACjC,mDAA0E;AASnE,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;IAC1B,YACyC,cAAwC;QAAxC,mBAAc,GAAd,cAAc,CAA0B;IAC7E,CAAC;IAEL,KAAK,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,EAAE,KAAK,GAAG,EAAE;QAC9B,MAAM,SAAS,GAAG,GAAG,CAAC;QACtB,IAAI,KAAK,GAAG,SAAS,EAAE,CAAC;YACpB,KAAK,GAAG,SAAS,CAAC;QACtB,CAAC;QACD,4BAA4B;QAC5B,MAAM,SAAS,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACtC,MAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QACrC,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;IACrE,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,kBAAsC;QAC/C,MAAM,gBAAgB,GAAG,IAAI,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC;QACrE,OAAO,gBAAgB,CAAC,IAAI,EAAE,CAAC;IACnC,CAAC;IAED,MAAM;QACF,OAAO;YACH;gBACI,QAAQ,EAAE,wBAAwB;gBAClC,MAAM,EAAE,wGAAwG;aACnH;YACD;gBACI,QAAQ,EAAE,uCAAuC;gBACjD,MAAM,EAAE,uEAAuE;aAClF;SACJ,CAAC;IACN,CAAC;IAED,KAAK,CAAC,IAAI;QACN,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;QACzD,IAAI,KAAK,KAAK,CAAC,EAAE,CAAC;YACd,MAAM,UAAU,GAAG;gBACf,EAAE,IAAI,EAAE,iBAAiB,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,WAAW,EAAE,4BAA4B,EAAE;gBACrG,EAAE,IAAI,EAAE,iBAAiB,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,WAAW,EAAE,uBAAuB,EAAE;gBAChG,EAAE,IAAI,EAAE,gBAAgB,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,WAAW,EAAE,2BAA2B,EAAE;gBACpG,EAAE,IAAI,EAAE,aAAa,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,EAAE,WAAW,EAAE,8BAA8B,EAAE;aACxG,CAAC;YACF,MAAM,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACrD,CAAC;IACL,CAAC;CACJ;AA9CY,8CAAiB;4BAAjB,iBAAiB;IAD7B,uBAAU,GAAE;IAGJ,6CAAW,EAAC,4BAAS,CAAC,IAAI,CAAC;iEAAyB,gBAAK,oBAAL,gBAAK;GAFrD,iBAAiB,CA8C7B;;;;;;;;;;;AC1DD,0CAA+D;AAMxD,IAAM,SAAS,GAAf,MAAM,SAAS;CAYrB;AAZY,8BAAS;AAElB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;uCACX;AAGd;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;2CACP;AAGlB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;wCACV;AAGf;IADC,mBAAI,GAAE;;8CACc;oBAXZ,SAAS;IADrB,qBAAM,GAAE;GACI,SAAS,CAYrB;AAEY,uBAAe,GAAG,wBAAa,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;;;;;;;;;;;ACpBvE,wCAAwC;AACxC,0CAAkD;AAClD,mDAAqD;AACrD,gDAA+C;AAC/C,+CAA4D;AAC5D,wCAA8C;AAUvC,IAAM,WAAW,GAAjB,MAAM,WAAW;CAAI;AAAf,kCAAW;sBAAX,WAAW;IARvB,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,yBAAc,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,EAAE,oBAAK,CAAC,IAAI,EAAE,MAAM,EAAE,0BAAW,EAAE,CAAC,CAAC;YACtE,qBAAY;SACf;QACD,WAAW,EAAE,CAAC,kCAAe,CAAC;QAC9B,SAAS,EAAE,CAAC,4BAAY,CAAC;KAC5B,CAAC;GACW,WAAW,CAAI;;;;;;;;;;;;ACf5B,wCAAkH;AAClH,gDAA+C;AAC/C,sDAAgE;AAGzD,IAAM,eAAe,GAArB,MAAM,eAAe;IACxB,YAA6B,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;IAAI,CAAC;IAItD,KAAD,CAAC,SAAS,CAAQ,GAAQ,EAAU,IAAiC;QACtE,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QACtB,OAAO,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;IACvG,CAAC;IAGK,KAAD,CAAC,QAAQ;QACV,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;IACxC,CAAC;IAIK,KAAD,CAAC,YAAY,CAAQ,GAAQ,EAAe,EAAU,EAAU,IAA2D;QAC5H,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;YAC5B,MAAM,IAAI,8BAAqB,CAAC,+BAA+B,CAAC,CAAC;QACrE,CAAC;QACD,OAAO,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IAC3D,CAAC;CACJ;AAvBY,0CAAe;AAKlB;IAFL,iBAAI,GAAE;IACN,sBAAS,EAAC,uCAAiB,CAAC;IACZ,mCAAG,GAAE;IAAY,oCAAI,GAAE;;;;gDAGvC;AAGK;IADL,gBAAG,GAAE;;;;+CAGL;AAIK;IAFL,kBAAK,EAAC,YAAY,CAAC;IACnB,sBAAS,EAAC,uCAAiB,CAAC;IACT,mCAAG,GAAE;IAAY,qCAAK,EAAC,IAAI,CAAC;IAAc,oCAAI,GAAE;;;;mDAKnE;0BAtBQ,eAAe;IAD3B,uBAAU,EAAC,OAAO,CAAC;iEAE2B,4BAAY,oBAAZ,4BAAY;GAD9C,eAAe,CAuB3B;;;;;;;;;;;;AC5BD,wCAA4C;AAC5C,0CAA+C;AAC/C,2CAAiC;AACjC,+CAA8D;AAGvD,IAAM,YAAY,GAAlB,MAAM,YAAY;IACrB,YACqC,UAAgC;QAAhC,eAAU,GAAV,UAAU,CAAsB;IACjE,CAAC;IAEL,KAAK,CAAC,UAAU,CAAC,MAAc,EAAE,SAAiB,EAAE,QAAgB,EAAE,eAAuB;QACzF,mCAAmC;QACnC,MAAM,UAAU,GAAG,IAAI,IAAI,EAAE,CAAC;QAC9B,UAAU,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAEhC,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,UAAU;aAClC,OAAO,CAAC,EAAE,SAAS,EAAE,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,CAAC;aAC5C,IAAI,CAAC,EAAE,cAAc,EAAE,CAAC,CAAC,EAAE,CAAC;aAC5B,IAAI,EAAE,CAAC;QAEZ,MAAM,cAAc,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEpE,MAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC;YACjC,MAAM;YACN,SAAS;YACT,QAAQ;YACR,eAAe;YACf,cAAc;YACd,MAAM,EAAE,SAAS;SACpB,CAAC,CAAC;QAEH,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;IAC3B,CAAC;IAED,KAAK,CAAC,QAAQ;QACV,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,aAAa,CAAC,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IACpH,CAAC;IAED,KAAK,CAAC,YAAY,CAAC,EAAU,EAAE,MAAiD;QAC5E,OAAO,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IACnF,CAAC;CACJ;AApCY,oCAAY;uBAAZ,YAAY;IADxB,uBAAU,GAAE;IAGJ,6CAAW,EAAC,oBAAK,CAAC,IAAI,CAAC;iEAAqB,gBAAK,oBAAL,gBAAK;GAF7C,YAAY,CAoCxB;;;;;;;;;;;AC1CD,0CAA+D;AAMxD,IAAM,KAAK,GAAX,MAAM,KAAK;CAkBjB;AAlBY,sBAAK;AAEd;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;qCACT;AAGhB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;wCACN;AAGnB;IADC,mBAAI,GAAE;;uCACW;AAGlB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;8CACA;AAGzB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;6CACD;AAGxB;IADC,mBAAI,EAAC,EAAE,OAAO,EAAE,SAAS,EAAE,CAAC;;qCACkC;gBAjBtD,KAAK;IADjB,qBAAM,EAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;GAChB,KAAK,CAkBjB;AAEY,mBAAW,GAAG,wBAAa,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;;;;;;;;;;;;AC1B/D,wCAAkG;AAClG,wCAA+C;AAC/C,6DAAiC;AAG1B,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;IAG1B,YAAoB,aAA4B;QAA5B,kBAAa,GAAb,aAAa,CAAe;IAAI,CAAC;IAErD,WAAW,CAAC,OAAyB;QACjC,MAAM,OAAO,GAAG,OAAO,CAAC,YAAY,EAAE,CAAC,UAAU,EAAE,CAAC;QACpD,MAAM,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC;QAEzD,IAAI,CAAC,QAAQ,EAAE,CAAC;YACZ,MAAM,IAAI,8BAAqB,CAAC,2BAA2B,CAAC,CAAC;QACjE,CAAC;QAED,IAAI,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,CAAC;YAClC,gCAAgC;YAChC,MAAM,SAAS,GAAG,IAAI,eAAe,CAAC,QAAQ,CAAC,CAAC;YAChD,MAAM,UAAU,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACzC,IAAI,UAAU,EAAE,CAAC;gBACb,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;gBACtC,sBAAsB;gBACtB,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAS,mBAAmB,CAAC,CAAC;gBACpE,OAAO,CAAC,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC;YACjF,CAAC;YACD,OAAO,IAAI,CAAC;QAChB,CAAC;QAED,MAAM,IAAI,8BAAqB,CAAC,2BAA2B,CAAC,CAAC;IACjE,CAAC;IAEO,gBAAgB,CAAC,QAAgB;QACrC,MAAM,SAAS,GAAG,IAAI,eAAe,CAAC,QAAQ,CAAC,CAAC;QAChD,MAAM,IAAI,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACnC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAEzB,MAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;aAClD,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACxC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,GAAG,GAAG,IAAI,KAAK,EAAE,CAAC;aACxC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEhB,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAE/B,IAAI,CAAC,SAAS,EAAE,CAAC;YACb,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAS,gBAAgB,CAAC,CAAC;YAC/D,IAAI,CAAC,KAAK,EAAE,CAAC;gBACT,MAAM,IAAI,8BAAqB,CAAC,+BAA+B,CAAC,CAAC;YACrE,CAAC;YACD,SAAS,GAAG,MAAM;iBACb,UAAU,CAAC,QAAQ,EAAE,YAAY,CAAC;iBAClC,MAAM,CAAC,KAAK,CAAC;iBACb,MAAM,EAAE,CAAC;YACd,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC/B,CAAC;QAED,MAAM,cAAc,GAAG,MAAM;aACxB,UAAU,CAAC,QAAQ,EAAE,SAAS,CAAC;aAC/B,MAAM,CAAC,eAAe,CAAC;aACvB,MAAM,CAAC,KAAK,CAAC,CAAC;QAEnB,OAAO,cAAc,KAAK,IAAI,CAAC;IACnC,CAAC;CACJ;AA5DY,8CAAiB;4BAAjB,iBAAiB;IAD7B,uBAAU,GAAE;iEAI0B,sBAAa,oBAAb,sBAAa;GAHvC,iBAAiB,CA4D7B;;;;;;;ACjED,mC;;;;;;;;;;ACAA,wCAAwC;AACxC,oDAAuD;AACvD,iDAAiD;AACjD,wCAA8C;AAQvC,IAAM,YAAY,GAAlB,MAAM,YAAY;CAAI;AAAhB,oCAAY;uBAAZ,YAAY;IANxB,mBAAM,EAAC;QACJ,OAAO,EAAE,CAAC,qBAAY,CAAC;QACvB,WAAW,EAAE,CAAC,oCAAgB,CAAC;QAC/B,SAAS,EAAE,CAAC,8BAAa,CAAC;QAC1B,OAAO,EAAE,CAAC,8BAAa,CAAC;KAC3B,CAAC;GACW,YAAY,CAAI;;;;;;;;;;;;ACX7B,wCAAmE;AACnE,iDAAiD;AAI1C,IAAM,gBAAgB,GAAtB,MAAM,gBAAgB;IACzB,YAA6B,aAA4B;QAA5B,kBAAa,GAAb,aAAa,CAAe;IAAI,CAAC;IAIxD,yFADmF;IACzF,KAAK,CAAC,IAAI,CAAS,IAAyB;QACxC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7D,OAAO,EAAE,QAAQ,EAAE,CAAC;IACxB,CAAC;CACJ;AATY,4CAAgB;AAKnB;IAFL,iBAAI,GAAE;IACP,yFAAyF;;IAC7E,oCAAI,GAAE;;;;4CAGjB;2BARQ,gBAAgB;IAD5B,uBAAU,EAAC,MAAM,CAAC;iEAE6B,8BAAa,oBAAb,8BAAa;GADhD,gBAAgB,CAS5B;;;;;;;;;;;;ACdD,wCAA0D;AAC1D,wCAA+C;AAC/C,gDAAqF;AAErF,8DAAmC;AACnC,2DAA6B;AAItB,IAAM,aAAa,GAAnB,MAAM,aAAa;IAKtB,YAAoB,aAA4B;QAA5B,kBAAa,GAAb,aAAa,CAAe;QAFxC,YAAO,GAAG,EAAE,CAAC;QAGjB,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAS,gBAAgB,CAAC,IAAI,mBAAmB,CAAC;QACvF,IAAI,CAAC,KAAK,GAAG,IAAI,kCAAkB,CAAC,MAAM,CAAC,CAAC;IAChD,CAAC;IAED,KAAK,CAAC,YAAY;QACd,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;QACzB,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;QAE3D,IAAI,CAAC,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC;YAC7C,KAAK,EAAE,kBAAkB;YACzB,iBAAiB,EAAE,IAAI,CAAC,iBAAiB,EAAE;SAC9C,CAAC,CAAC;IACP,CAAC;IAEO,iBAAiB;QACrB,OAAO;;;;UAIL,IAAI,CAAC,OAAO;;;;;;;;;;;;;;;;;;;;SAoBb,CAAC;IACN,CAAC;IAGG,KAAK,CAAC,WAAW;QACvB,IAAI,CAAC;YACH,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC;YAChE,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;YAE/D,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,KAAK,CAAC;YAC5B,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;QAE7D,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,MAAM,QAAQ,GAAG,KAAK,YAAY,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YACxE,OAAO,CAAC,KAAK,CAAC,0CAA0C,EAAE,QAAQ,CAAC,CAAC;YACpE,IAAI,CAAC,OAAO,GAAG,gDAAgD,CAAC;QAClE,CAAC;IACH,CAAC;IAEG,KAAK,CAAC,IAAI,CAAC,OAAe;QACtB,OAAO,MAAM,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACtF,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,OAAkB;QACpC,IAAI,CAAC;YACD,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAE5C,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;gBAC9B,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aAChC,CAAC,CAAC;YAEH,MAAM,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC;YACzC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC5C,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,QAAQ,CAAC;YACvC,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;QAC3B,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACb,OAAO,CAAC,KAAK,CAAC,mBAAmB,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;YACnE,IAAI,KAAK,YAAY,KAAK,EAAE,CAAC;gBACzB,OAAO,CAAC,KAAK,CAAC,gBAAgB,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;YACnD,CAAC;YACD,OAAO,6EAA6E,CAAC;QACzF,CAAC;IACL,CAAC;CACJ;AAxFY,sCAAa;wBAAb,aAAa;IADzB,uBAAU,GAAE;iEAM0B,sBAAa,oBAAb,sBAAa;GALvC,aAAa,CAwFzB;;;;;;;ACjGD,kD;;;;;;ACAA,oC;;;;;;ACAA,iC;;;;;;;;;;ACAA,wCAAwC;AACxC,0CAAkD;AAClD,kDAAmD;AACnD,+CAA6C;AAC7C,8CAAyD;AACzD,gDAAuD;AACvD,wCAA8C;AAYvC,IAAM,UAAU,GAAhB,MAAM,UAAU;CAAI;AAAd,gCAAU;qBAAV,UAAU;IAVtB,mBAAM,EAAC;QACJ,OAAO,EAAE;YACL,yBAAc,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,EAAE,kBAAI,CAAC,IAAI,EAAE,MAAM,EAAE,wBAAU,EAAE,CAAC,CAAC;YACpE,4BAAY;YACZ,qBAAY;SACf;QACD,WAAW,EAAE,CAAC,gCAAc,CAAC;QAC7B,SAAS,EAAE,CAAC,0BAAW,CAAC;QACxB,OAAO,EAAE,CAAC,0BAAW,CAAC;KACzB,CAAC;GACW,UAAU,CAAI;;;;;;;;;;;;AClB3B,wCAAwD;AACxD,+CAA6C;AAC7C,mDAAwD;AAGjD,IAAM,cAAc,GAApB,MAAM,cAAc;IACvB,YAA6B,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;IAAI,CAAC;IAIpD,gCAD0B;IAChC,KAAK,CAAC,WAAW,CAAS,IAAoB;QAC1C,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAE5B,OAAO;YACH,QAAQ,EAAE,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC;SAC5E,CAAC;IACN,CAAC;CACJ;AAZY,wCAAc;AAKjB;IAFL,iBAAI,EAAC,SAAS,CAAC;IAChB,gCAAgC;;IACb,oCAAI,GAAE;;iEAAO,iCAAc,oBAAd,iCAAc;;iDAM7C;yBAXQ,cAAc;IAD1B,uBAAU,EAAC,MAAM,CAAC;iEAE2B,0BAAW,oBAAX,0BAAW;GAD5C,cAAc,CAY1B;;;;;;;;;;;;;ACjBD,wCAAoD;AACpD,0CAA+C;AAC/C,2CAAiC;AACjC,8CAA2D;AAC3D,iDAAyD;AAGlD,IAAM,WAAW,mBAAjB,MAAM,WAAW;IAGpB,YAC4B,SAAsC,EACtD,aAA4B;QADJ,cAAS,GAAT,SAAS,CAAqB;QACtD,kBAAa,GAAb,aAAa,CAAe;QAJvB,WAAM,GAAG,IAAI,eAAM,CAAC,aAAW,CAAC,IAAI,CAAC,CAAC;IAKnD,CAAC;IAEL,KAAK,CAAC,aAAa,CAAC,MAAc,EAAE,OAAe;QAC/C,IAAI,IAAI,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC;QACpD,IAAI,CAAC,IAAI,EAAE,CAAC;YACR,IAAI,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,CAAC;QACvD,CAAC;QAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,IAAI,IAAI,EAAE,EAAE,CAAC,CAAC;QAE1E,+DAA+D;QAC/D,MAAM,WAAW,GAAG,EAAE,CAAC;QACvB,MAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC,CAAC;QAEvD,MAAM,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC3C,IAAI,EAAE,GAAG,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO;YAC5C,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,CAAC;SAC9B,CAAC,CAAC,CAAC;QAEJ,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;QAE5E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,YAAY,EAAE,SAAS,EAAE,IAAI,IAAI,EAAE,EAAE,CAAC,CAAC;QAChF,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;QAElB,OAAO,YAAY,CAAC;IACxB,CAAC;CACJ;AAhCY,kCAAW;sBAAX,WAAW;IADvB,uBAAU,GAAE;IAKJ,6CAAW,EAAC,kBAAI,CAAC,IAAI,CAAC;iEAAoB,gBAAK,oBAAL,gBAAK,oDACzB,8BAAa,oBAAb,8BAAa;GAL/B,WAAW,CAgCvB;;;;;;;;;;;;ACvCD,0CAA+D;AAMxD,IAAM,OAAO,GAAb,MAAM,OAAO;CASnB;AATY,0BAAO;AAEhB;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,CAAC;;qCACpC;AAGd;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;qCACX;AAGd;IADC,mBAAI,EAAC,EAAE,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;0DAChB,IAAI,oBAAJ,IAAI;0CAAC;kBARR,OAAO;IADnB,qBAAM,GAAE;GACI,OAAO,CASnB;AAEY,qBAAa,GAAG,wBAAa,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;AAG5D,IAAM,IAAI,GAAV,MAAM,IAAI;CAMhB;AANY,oBAAI;AAEb;IADC,mBAAI,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;;oCACvB;AAGhB;IADC,mBAAI,EAAC,EAAE,IAAI,EAAE,CAAC,qBAAa,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC;;qCACzB;eALX,IAAI;IADhB,qBAAM,EAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;GAChB,IAAI,CAMhB;AAEY,kBAAU,GAAG,wBAAa,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;;;;;;;;;;;AC5B7D,kDAAuD;AAEvD,MAAa,cAAc;CAQ1B;AARD,wCAQC;AALC;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;+CACI;AAIjB;IAFC,8BAAQ,GAAE;IACV,gCAAU,GAAE;;8CACG;;;;;;UCTlB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;ACtBA;;;GAGG;;AAEH,wCAAwD;AACxD,sCAA2C;AAC3C,4CAA6C;AAE7C,KAAK,UAAU,SAAS;IACtB,MAAM,GAAG,GAAG,MAAM,kBAAW,CAAC,MAAM,CAAC,sBAAS,CAAC,CAAC;IAChD,GAAG,CAAC,cAAc,CAAC,IAAI,uBAAc,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IAC5D,MAAM,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC;IACtC,8BAA8B;IAC9B,mBAAmB;IACnB,mEAAmE;IACnE,cAAc;IACd,4CAA4C;IAC5C,uBAAuB;IACvB,sDAAsD;IACtD,OAAO;IACP,+CAA+C;IAC/C,iFAAiF;IACjF,uBAAuB;IACvB,MAAM;IACN,GAAG,CAAC,UAAU,CAAC;QACb,MAAM,EAAE,IAAI,EAAE,2DAA2D;QACzE,OAAO,EAAE,wCAAwC;QACjD,WAAW,EAAE,IAAI;QACjB,cAAc,EAAE,GAAG,EAAE,wDAAwD;QAC7E,MAAM,EAAE,IAAI;KACb,CAAC,CAAC;IACH,MAAM,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACvB,eAAM,CAAC,GAAG,CACR,kDAAkD,IAAI,EAAE,CACzD,CAAC;AACJ,CAAC;AAED,SAAS,EAAE,CAAC","sources":["webpack:///external commonjs \"@nestjs/common\"","webpack:///external commonjs \"@nestjs/core\"","webpack:///./src/app/app.module.ts","webpack:///external commonjs \"tslib\"","webpack:///external commonjs \"@nestjs/config\"","webpack:///./src/app/app.controller.ts","webpack:///./src/app/app.service.ts","webpack:///external commonjs \"@nestjs/mongoose\"","webpack:///./src/app/auth/auth.module.ts","webpack:///./src/app/auth/auth.service.ts","webpack:///external commonjs \"@nestjs/jwt\"","webpack:///external commonjs \"mongoose\"","webpack:///./src/app/users/schemas/user.schema.ts","webpack:///external commonjs \"bcrypt\"","webpack:///./src/app/auth/auth.controller.ts","webpack:///./src/app/auth/dto/login.dto.ts","webpack:///external commonjs \"class-validator\"","webpack:///./src/app/auth/dto/register.dto.ts","webpack:///./src/app/users/users.module.ts","webpack:///external commonjs \"@nestjs/passport\"","webpack:///./src/app/auth/jwt.strategy.ts","webpack:///external commonjs \"passport-jwt\"","webpack:///./src/app/booking/booking.module.ts","webpack:///./src/app/booking/schemas/venue.schema.ts","webpack:///./src/app/booking/schemas/appointment.schema.ts","webpack:///./src/app/booking/booking.service.ts","webpack:///./src/app/booking/booking.controller.ts","webpack:///./src/app/booking/dto/create-venue.dto.ts","webpack:///./src/app/booking/dto/create-appointment.dto.ts","webpack:///./src/app/telegram/telegram.module.ts","webpack:///external commonjs \"nestjs-telegraf\"","webpack:///./src/app/telegram/telegram.service.ts","webpack:///external commonjs \"telegraf\"","webpack:///./src/app/treatments/treatments.module.ts","webpack:///./src/app/treatments/treatments.controller.ts","webpack:///./src/app/treatments/treatments.service.ts","webpack:///./src/app/treatments/schemas/treatment.schema.ts","webpack:///./src/app/queue/queue.module.ts","webpack:///./src/app/queue/queue.controller.ts","webpack:///./src/app/queue/queue.service.ts","webpack:///./src/app/queue/schemas/queue.schema.ts","webpack:///./src/app/auth/telegram-auth.guard.ts","webpack:///external node-commonjs \"crypto\"","webpack:///./src/app/gemini/gemini.module.ts","webpack:///./src/app/gemini/gemini.controller.ts","webpack:///./src/app/gemini/gemini.service.ts","webpack:///external commonjs \"@google/generative-ai\"","webpack:///external commonjs \"mammoth\"","webpack:///external node-commonjs \"path\"","webpack:///./src/app/chat/chat.module.ts","webpack:///./src/app/chat/chat.controller.ts","webpack:///./src/app/chat/chat.service.ts","webpack:///./src/app/chat/schemas/chat.schema.ts","webpack:///./src/app/chat/dto/send-message.dto.ts","webpack:///webpack/bootstrap","webpack:///./src/main.ts"],"sourcesContent":["module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/core\");","import { Module } from '@nestjs/common';\nimport { ConfigModule } from '@nestjs/config';\nimport { AppController } from './app.controller';\nimport { AppService } from './app.service';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { AuthModule } from './auth/auth.module';\nimport { BookingModule } from './booking/booking.module';\nimport { TelegramModule } from './telegram/telegram.module';\nimport { UsersModule } from './users/users.module';\nimport { TreatmentsModule } from './treatments/treatments.module';\nimport { QueueModule } from './queue/queue.module';\nimport { GeminiModule } from './gemini/gemini.module';\nimport { ChatModule } from './chat/chat.module';\n\n@Module({\n  imports: [\n    MongooseModule.forRootAsync({\n      useFactory: () => ({\n        uri: process.env.MONGODB_URI_ONLINE,\n        connectTimeoutMS: 10000,\n        socketTimeoutMS: 45000,\n        family: 4,\n      }),\n    }),\n    ConfigModule.forRoot({\n      isGlobal: true,\n      envFilePath: `${process.cwd()}/.env`,\n    }),\n    AuthModule,\n    BookingModule,\n    TelegramModule,\n    UsersModule,\n    TreatmentsModule,\n    QueueModule,\n    GeminiModule,\n    ChatModule,\n  ],\n  controllers: [AppController],\n  providers: [AppService],\n})\nexport class AppModule { }\n\n","module.exports = require(\"tslib\");","module.exports = require(\"@nestjs/config\");","import { Controller, Get } from '@nestjs/common';\nimport { AppService } from './app.service';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) { }\n\n  @Get('')\n  getData() {\n    return 'Hello World!';\n  }\n}\n","import { Injectable } from '@nestjs/common';\n\n@Injectable()\nexport class AppService {\n  getData(): { message: string } {\n    return { message: 'Hello API' };\n  }\n}\n","module.exports = require(\"@nestjs/mongoose\");","import { Module } from '@nestjs/common';\nimport { AuthService } from './auth.service';\nimport { AuthController } from './auth.controller';\nimport { UsersModule } from '../users/users.module';\nimport { PassportModule } from '@nestjs/passport';\nimport { JwtModule } from '@nestjs/jwt';\nimport { JwtStrategy } from './jwt.strategy';\nimport { ConfigModule, ConfigService } from '@nestjs/config';\n\n@Module({\n    imports: [\n        UsersModule,\n        PassportModule,\n        JwtModule.registerAsync({\n            imports: [ConfigModule],\n            useFactory: async (configService: ConfigService) => {\n                const secret = configService.get<string>('JWT_SECRET');\n                if (!secret) {\n                    throw new Error('JWT_SECRET is not defined');\n                }\n                return {\n                    secret: secret,\n                    signOptions: { expiresIn: '60m' },\n                };\n            },\n            inject: [ConfigService],\n        }),\n    ],\n    controllers: [AuthController],\n    providers: [AuthService, JwtStrategy],\n    exports: [AuthService],\n})\nexport class AuthModule { }\n","import { Injectable } from '@nestjs/common';\nimport { JwtService } from '@nestjs/jwt';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model, Types } from 'mongoose';\nimport { User, UserDocument } from '../users/schemas/user.schema';\nimport * as bcrypt from 'bcrypt';\n\n@Injectable()\nexport class AuthService {\n    constructor(\n        @InjectModel(User.name) private userModel: Model<UserDocument>,\n        private jwtService: JwtService\n    ) { }\n\n    async validateUser(email: string, pass: string): Promise<(Omit<User, 'passwordHash'> & { _id: Types.ObjectId }) | null> {\n        const user = await this.userModel.findOne({ email }).lean();\n        if (user && (await bcrypt.compare(pass, user.passwordHash))) {\n            const { passwordHash, ...result } = user;\n            return result as Omit<User, 'passwordHash'> & { _id: Types.ObjectId };\n        }\n        return null;\n    }\n\n    async login(user: Omit<User, 'passwordHash'> & { _id: Types.ObjectId | string }) {\n        const payload = { email: user.email, sub: user._id, role: user.role };\n        return {\n            access_token: this.jwtService.sign(payload),\n        };\n    }\n\n    async register(email: string, pass: string) {\n        const passwordHash = await bcrypt.hash(pass, 10);\n        const createdUser = new this.userModel({ email, passwordHash });\n        return createdUser.save();\n    }\n}\n","module.exports = require(\"@nestjs/jwt\");","module.exports = require(\"mongoose\");","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { HydratedDocument } from 'mongoose';\n\nexport type UserDocument = HydratedDocument<User>;\n\nexport enum UserRole {\n    ADMIN = 'ADMIN',\n    USER = 'USER',\n}\n\n@Schema({ timestamps: true })\nexport class User {\n    @Prop({ required: true, unique: true })\n    email!: string;\n\n    @Prop({ required: true })\n    passwordHash!: string;\n\n    @Prop({ required: true, enum: UserRole, default: UserRole.USER })\n    role!: UserRole;\n\n    @Prop()\n    telegramId?: string;\n}\n\nexport const UserSchema = SchemaFactory.createForClass(User);\n","module.exports = require(\"bcrypt\");","import { Controller, Request, Post, UseGuards, Body } from '@nestjs/common';\nimport { AuthService } from './auth.service';\nimport { LoginDto } from './dto/login.dto';\nimport { RegisterDto } from './dto/register.dto';\n\n@Controller('auth')\nexport class AuthController {\n    constructor(private authService: AuthService) { }\n\n    @Post('login')\n    async login(@Body() body: LoginDto) {\n        // In a real app, use LocalAuthGuard to validate first\n        const user = await this.authService.validateUser(body.email, body.password);\n        if (!user) {\n            return { message: 'Invalid credentials' };\n        }\n        return this.authService.login(user);\n    }\n\n    @Post('register')\n    async register(@Body() body: RegisterDto) {\n        return this.authService.register(body.email, body.password);\n    }\n}\n","import { IsEmail, IsNotEmpty, IsString } from 'class-validator';\n\nexport class LoginDto {\n  @IsEmail({}, { message: 'Invalid email format' })\n  @IsNotEmpty()\n  email!: string;\n\n  @IsString()\n  @IsNotEmpty()\n  password!: string;\n}\n","module.exports = require(\"class-validator\");","import { IsEmail, IsNotEmpty, IsString, MinLength } from 'class-validator';\n\nexport class RegisterDto {\n  @IsEmail({}, { message: 'Invalid email format' })\n  @IsNotEmpty()\n  email!: string;\n\n  @IsString()\n  @IsNotEmpty()\n  @MinLength(6, { message: 'Password must be at least 6 characters long' })\n  password!: string;\n}\n","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { User, UserSchema } from './schemas/user.schema';\n\n@Module({\n    imports: [\n        MongooseModule.forFeature([{ name: User.name, schema: UserSchema }]),\n    ],\n    controllers: [],\n    providers: [],\n    exports: [MongooseModule],\n})\nexport class UsersModule { }\n","module.exports = require(\"@nestjs/passport\");","import { ExtractJwt, Strategy } from 'passport-jwt';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { Injectable } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\n\nexport interface JwtPayload {\n    sub: string;\n    email: string;\n    role: string;\n}\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n    constructor(configService: ConfigService) {\n        const secret = configService.get<string>('JWT_SECRET');\n        if (!secret) {\n            throw new Error('JWT_SECRET is not defined');\n        }\n        super({\n            jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n            ignoreExpiration: false,\n            secretOrKey: secret,\n        });\n    }\n\n    async validate(payload: JwtPayload) {\n        return { userId: payload.sub, email: payload.email, role: payload.role };\n    }\n}\n","module.exports = require(\"passport-jwt\");","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { Venue, VenueSchema } from './schemas/venue.schema';\nimport { Appointment, AppointmentSchema } from './schemas/appointment.schema';\nimport { BookingService } from './booking.service';\nimport { BookingController } from './booking.controller';\n\n@Module({\n    imports: [\n        MongooseModule.forFeature([\n            { name: Venue.name, schema: VenueSchema },\n            { name: Appointment.name, schema: AppointmentSchema },\n        ]),\n    ],\n    controllers: [BookingController],\n    providers: [BookingService],\n})\nexport class BookingModule { }\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { HydratedDocument } from 'mongoose';\n\nexport type VenueDocument = HydratedDocument<Venue>;\n\n@Schema({ timestamps: true })\nexport class Venue {\n    @Prop({ required: true })\n    name!: string;\n\n    @Prop()\n    address!: string;\n\n    @Prop({ type: [String], default: [] })\n    images!: string[];\n\n    @Prop({ required: true })\n    capacity!: number;\n}\n\nexport const VenueSchema = SchemaFactory.createForClass(Venue);\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { HydratedDocument, Types } from 'mongoose';\nimport { User } from '../../users/schemas/user.schema';\nimport { Venue } from './venue.schema';\n\nexport type AppointmentDocument = HydratedDocument<Appointment>;\n\nexport enum AppointmentStatus {\n    PENDING = 'PENDING',\n    CONFIRMED = 'CONFIRMED',\n    CANCELLED = 'CANCELLED',\n}\n\n@Schema({ timestamps: true })\nexport class Appointment {\n    @Prop({ type: Types.ObjectId, ref: 'User', required: true })\n    user!: User;\n\n    @Prop({ type: Types.ObjectId, ref: 'Venue', required: true })\n    venue!: Venue;\n\n    @Prop({ required: true })\n    startTime!: Date;\n\n    @Prop({ required: true })\n    endTime!: Date;\n\n    @Prop({ required: true, enum: AppointmentStatus, default: AppointmentStatus.PENDING })\n    status!: AppointmentStatus;\n}\n\nexport const AppointmentSchema = SchemaFactory.createForClass(Appointment);\n","import { Injectable } from '@nestjs/common';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model } from 'mongoose';\nimport { Venue, VenueDocument } from './schemas/venue.schema';\nimport { Appointment, AppointmentDocument } from './schemas/appointment.schema';\nimport { CreateVenueDto } from './dto/create-venue.dto';\nimport { CreateAppointmentDto } from './dto/create-appointment.dto';\n\n@Injectable()\nexport class BookingService {\n    constructor(\n        @InjectModel(Venue.name) private venueModel: Model<VenueDocument>,\n        @InjectModel(Appointment.name) private appointmentModel: Model<AppointmentDocument>\n    ) { }\n\n    async createVenue(createVenueDto: CreateVenueDto): Promise<Venue> {\n        const createdVenue = new this.venueModel(createVenueDto);\n        return createdVenue.save();\n    }\n\n    async findAllVenues(page = 1, limit = 10): Promise<Venue[]> {\n        const MAX_LIMIT = 100;\n        if (limit > MAX_LIMIT) {\n            limit = MAX_LIMIT;\n        }\n        const skip = (page - 1) * limit;\n        return this.venueModel.find().skip(skip).limit(limit).exec();\n    }\n\n    async createAppointment(createAppointmentDto: CreateAppointmentDto): Promise<Appointment> {\n        const createdAppointment = new this.appointmentModel(createAppointmentDto);\n        return createdAppointment.save();\n    }\n\n    async findAllAppointments(page = 1, limit = 10): Promise<Appointment[]> {\n        const MAX_LIMIT = 100;\n        if (limit > MAX_LIMIT) {\n            limit = MAX_LIMIT;\n        }\n        const skip = (page - 1) * limit;\n        return this.appointmentModel.find().populate('user', 'email role').populate('venue', 'name address').skip(skip).limit(limit).exec();\n    }\n}\n","import { Controller, Get, Post, Body, UseGuards, Query, ParseIntPipe, DefaultValuePipe } from '@nestjs/common';\nimport { BookingService } from './booking.service';\nimport { AuthGuard } from '@nestjs/passport';\nimport { CreateVenueDto } from './dto/create-venue.dto';\nimport { CreateAppointmentDto } from './dto/create-appointment.dto';\n\n@Controller('booking')\nexport class BookingController {\n    constructor(private readonly bookingService: BookingService) { }\n\n    @Post('venues')\n    // @UseGuards(AuthGuard('jwt')) // Uncomment to protect\n    createVenue(@Body() createVenueDto: CreateVenueDto) {\n        return this.bookingService.createVenue(createVenueDto);\n    }\n\n    @Get('venues')\n    findAllVenues(\n        @Query('page', new DefaultValuePipe(1), ParseIntPipe) page: number,\n        @Query('limit', new DefaultValuePipe(10), ParseIntPipe) limit: number\n    ) {\n        return this.bookingService.findAllVenues(page, limit);\n    }\n\n    @Post('appointments')\n    // @UseGuards(AuthGuard('jwt'))\n    createAppointment(@Body() createAppointmentDto: CreateAppointmentDto) {\n        return this.bookingService.createAppointment(createAppointmentDto);\n    }\n\n    @Get('appointments')\n    findAllAppointments(\n        @Query('page', new DefaultValuePipe(1), ParseIntPipe) page: number,\n        @Query('limit', new DefaultValuePipe(10), ParseIntPipe) limit: number\n    ) {\n        return this.bookingService.findAllAppointments(page, limit);\n    }\n}\n","import { IsNotEmpty, IsString, IsNumber, IsOptional, IsArray } from 'class-validator';\n\nexport class CreateVenueDto {\n  @IsString()\n  @IsNotEmpty()\n  name!: string;\n\n  @IsString()\n  @IsOptional()\n  address?: string;\n\n  @IsArray()\n  @IsString({ each: true })\n  @IsOptional()\n  images?: string[];\n\n  @IsNumber()\n  @IsNotEmpty()\n  capacity!: number;\n}\n","import { IsNotEmpty, IsString, IsDateString, IsEnum, IsOptional } from 'class-validator';\nimport { AppointmentStatus } from '../schemas/appointment.schema';\n\nexport class CreateAppointmentDto {\n  @IsString()\n  @IsNotEmpty()\n  user!: string;\n\n  @IsString()\n  @IsNotEmpty()\n  venue!: string;\n\n  @IsDateString()\n  @IsNotEmpty()\n  startTime!: string;\n\n  @IsDateString()\n  @IsNotEmpty()\n  endTime!: string;\n\n  @IsEnum(AppointmentStatus)\n  @IsOptional()\n  status?: AppointmentStatus;\n}\n","import { Module } from '@nestjs/common';\nimport { TelegrafModule } from 'nestjs-telegraf';\nimport { TelegramService } from './telegram.service';\nimport { ConfigService } from '@nestjs/config';\n@Module({\n    imports: [\n        TelegrafModule.forRootAsync({\n            // 1. Указываем, какие сервисы нужно внедрить (инжектировать)\n            inject: [ConfigService],\n            // 2. Используем фабрику для создания конфигурации\n            useFactory: (config: ConfigService) => ({\n                token: config.get<string>('TELEGRAM_TOKEN') || '',\n            }),\n        }),\n    ],\n    controllers: [],\n    providers: [TelegramService],\n})\nexport class TelegramModule { }\n","module.exports = require(\"nestjs-telegraf\");","import { Injectable } from '@nestjs/common';\nimport { Context, Telegraf } from 'telegraf';\nimport { InjectBot, Start, Update } from 'nestjs-telegraf';\n\n@Update()\n@Injectable()\nexport class TelegramService {\n    constructor(@InjectBot() private bot: Telegraf<Context>) { }\n\n    @Start()\n    async start(ctx: Context) {\n        await ctx.reply('Welcome');\n    }\n}\n","module.exports = require(\"telegraf\");","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { TreatmentsController } from './treatments.controller';\nimport { TreatmentsService } from './treatments.service';\nimport { Treatment, TreatmentSchema } from './schemas/treatment.schema';\n\n@Module({\n    imports: [\n        MongooseModule.forFeature([{ name: Treatment.name, schema: TreatmentSchema }]),\n    ],\n    controllers: [TreatmentsController],\n    providers: [TreatmentsService],\n})\nexport class TreatmentsModule { }\n","import { Controller, Get, Post, Body, Query, ParseIntPipe, DefaultValuePipe } from '@nestjs/common';\nimport { TreatmentsService } from './treatments.service';\n\n@Controller('treatments')\nexport class TreatmentsController {\n    constructor(private readonly treatmentsService: TreatmentsService) { }\n\n    @Get()\n    async findAll(\n        @Query('page', new DefaultValuePipe(1), ParseIntPipe) page: number,\n        @Query('limit', new DefaultValuePipe(10), ParseIntPipe) limit: number\n    ) {\n        return this.treatmentsService.findAll(page, limit);\n    }\n\n    @Get('faq')\n    getFaq() {\n        return this.treatmentsService.getFaq();\n    }\n\n    @Post('seed')\n    async seed() {\n        await this.treatmentsService.seed();\n        return { message: 'Seeded successfully' };\n    }\n}\n","import { Injectable } from '@nestjs/common';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model } from 'mongoose';\nimport { Treatment, TreatmentDocument } from './schemas/treatment.schema';\nimport { CreateTreatmentDto } from './dto/create-treatment.dto';\n\nexport interface FaqItem {\n    question: string;\n    answer: string;\n}\n\n@Injectable()\nexport class TreatmentsService {\n    constructor(\n        @InjectModel(Treatment.name) private treatmentModel: Model<TreatmentDocument>\n    ) { }\n\n    async findAll(page = 1, limit = 10): Promise<Treatment[]> {\n        const MAX_LIMIT = 100;\n        if (limit > MAX_LIMIT) {\n            limit = MAX_LIMIT;\n        }\n        // Ensure page is at least 1\n        const validPage = page < 1 ? 1 : page;\n        const skip = (validPage - 1) * limit;\n        return this.treatmentModel.find().skip(skip).limit(limit).exec();\n    }\n\n    async create(createTreatmentDto: CreateTreatmentDto): Promise<Treatment> {\n        const createdTreatment = new this.treatmentModel(createTreatmentDto);\n        return createdTreatment.save();\n    }\n\n    getFaq(): FaqItem[] {\n        return [\n            {\n                question: 'Does diode laser hurt?',\n                answer: 'Most patients describe the sensation as a light snap of a rubber band. It is generally well-tolerated.',\n            },\n            {\n                question: 'How should I prep for my appointment?',\n                answer: 'Shave the area 24 hours before. Avoid sun exposure for 2 weeks prior.',\n            },\n        ];\n    }\n\n    async seed() {\n        const count = await this.treatmentModel.countDocuments();\n        if (count === 0) {\n            const treatments = [\n                { name: 'Full Face Laser', category: 'Laser', price: 250, description: 'Complete face hair removal' },\n                { name: 'Underarms Laser', category: 'Laser', price: 100, description: 'Underarm hair removal' },\n                { name: 'Botox Forehead', category: 'Botox', price: 1200, description: 'Smooth out forehead lines' },\n                { name: 'HydraFacial', category: 'Facials', price: 400, description: 'Deep cleansing and hydration' },\n            ];\n            await this.treatmentModel.insertMany(treatments);\n        }\n    }\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document } from 'mongoose';\n\nexport type TreatmentDocument = Treatment & Document;\n\n@Schema()\nexport class Treatment {\n    @Prop({ required: true })\n    name!: string;\n\n    @Prop({ required: true })\n    category!: string; // 'Laser', 'Botox', 'Facials'\n\n    @Prop({ required: true })\n    price!: number; // In TJS\n\n    @Prop()\n    description?: string;\n}\n\nexport const TreatmentSchema = SchemaFactory.createForClass(Treatment);\n","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { QueueController } from './queue.controller';\nimport { QueueService } from './queue.service';\nimport { Queue, QueueSchema } from './schemas/queue.schema';\nimport { ConfigModule } from '@nestjs/config';\n\n@Module({\n    imports: [\n        MongooseModule.forFeature([{ name: Queue.name, schema: QueueSchema }]),\n        ConfigModule\n    ],\n    controllers: [QueueController],\n    providers: [QueueService],\n})\nexport class QueueModule { }\n","import { Controller, Get, Post, Body, UseGuards, Req, Patch, Param, UnauthorizedException } from '@nestjs/common';\nimport { QueueService } from './queue.service';\nimport { TelegramAuthGuard } from '../auth/telegram-auth.guard';\n\n@Controller('queue')\nexport class QueueController {\n    constructor(private readonly queueService: QueueService) { }\n\n    @Post()\n    @UseGuards(TelegramAuthGuard)\n    async joinQueue(@Req() req: any, @Body() body: { serviceCategory: string }) {\n        const user = req.user;\n        return this.queueService.addToQueue(user.id, user.first_name, user.username, body.serviceCategory);\n    }\n\n    @Get()\n    async getQueue() {\n        return this.queueService.getQueue();\n    }\n\n    @Patch(':id/status')\n    @UseGuards(TelegramAuthGuard)\n    async updateStatus(@Req() req: any, @Param('id') id: string, @Body() body: { status: 'in-progress' | 'completed' | 'cancelled' }) {\n        if (req.user.role !== 'admin') {\n            throw new UnauthorizedException('Only admins can update status');\n        }\n        return this.queueService.updateStatus(id, body.status);\n    }\n}\n","import { Injectable } from '@nestjs/common';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model } from 'mongoose';\nimport { Queue, QueueDocument } from './schemas/queue.schema';\n\n@Injectable()\nexport class QueueService {\n    constructor(\n        @InjectModel(Queue.name) private queueModel: Model<QueueDocument>\n    ) { }\n\n    async addToQueue(userId: number, firstName: string, username: string, serviceCategory: string): Promise<Queue> {\n        // Find today's max sequence number\n        const startOfDay = new Date();\n        startOfDay.setHours(0, 0, 0, 0);\n\n        const lastEntry = await this.queueModel\n            .findOne({ createdAt: { $gte: startOfDay } })\n            .sort({ sequenceNumber: -1 })\n            .exec();\n\n        const sequenceNumber = lastEntry ? lastEntry.sequenceNumber + 1 : 1;\n\n        const newEntry = new this.queueModel({\n            userId,\n            firstName,\n            username,\n            serviceCategory,\n            sequenceNumber,\n            status: 'waiting',\n        });\n\n        return newEntry.save();\n    }\n\n    async getQueue(): Promise<Queue[]> {\n        return this.queueModel.find({ status: { $in: ['waiting', 'in-progress'] } }).sort({ sequenceNumber: 1 }).exec();\n    }\n\n    async updateStatus(id: string, status: 'in-progress' | 'completed' | 'cancelled'): Promise<Queue | null> {\n        return this.queueModel.findByIdAndUpdate(id, { status }, { new: true }).exec();\n    }\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document } from 'mongoose';\n\nexport type QueueDocument = Queue & Document;\n\n@Schema({ timestamps: true })\nexport class Queue {\n    @Prop({ required: true })\n    userId!: number;\n\n    @Prop({ required: true })\n    firstName!: string;\n\n    @Prop()\n    username!: string;\n\n    @Prop({ required: true })\n    serviceCategory!: string; // 'Laser', 'Botox', etc.\n\n    @Prop({ required: true })\n    sequenceNumber!: number;\n\n    @Prop({ default: 'waiting' })\n    status!: 'waiting' | 'in-progress' | 'completed' | 'cancelled';\n}\n\nexport const QueueSchema = SchemaFactory.createForClass(Queue);\n","import { CanActivate, ExecutionContext, Injectable, UnauthorizedException } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\nimport * as crypto from 'crypto';\n\n@Injectable()\nexport class TelegramAuthGuard implements CanActivate {\n    private secretKey: Buffer | undefined;\n\n    constructor(private configService: ConfigService) { }\n\n    canActivate(context: ExecutionContext): boolean {\n        const request = context.switchToHttp().getRequest();\n        const initData = request.headers['x-telegram-init-data'];\n\n        if (!initData) {\n            throw new UnauthorizedException('Missing Telegram initData');\n        }\n\n        if (this.validateInitData(initData)) {\n            // Parse user data from initData\n            const urlParams = new URLSearchParams(initData);\n            const userString = urlParams.get('user');\n            if (userString) {\n                request.user = JSON.parse(userString);\n                // Add role logic here\n                const adminId = this.configService.get<string>('TELEGRAM_ADMIN_ID');\n                request.user.role = String(request.user.id) === adminId ? 'admin' : 'client';\n            }\n            return true;\n        }\n\n        throw new UnauthorizedException('Invalid Telegram initData');\n    }\n\n    private validateInitData(initData: string): boolean {\n        const urlParams = new URLSearchParams(initData);\n        const hash = urlParams.get('hash');\n        urlParams.delete('hash');\n\n        const dataCheckString = Array.from(urlParams.entries())\n            .sort((a, b) => a[0].localeCompare(b[0]))\n            .map(([key, value]) => `${key}=${value}`)\n            .join('\\n');\n\n        let secretKey = this.secretKey;\n\n        if (!secretKey) {\n            const token = this.configService.get<string>('TELEGRAM_TOKEN');\n            if (!token) {\n                throw new UnauthorizedException('Telegram token not configured');\n            }\n            secretKey = crypto\n                .createHmac('sha256', 'WebAppData')\n                .update(token)\n                .digest();\n            this.secretKey = secretKey;\n        }\n\n        const calculatedHash = crypto\n            .createHmac('sha256', secretKey)\n            .update(dataCheckString)\n            .digest('hex');\n\n        return calculatedHash === hash;\n    }\n}\n","module.exports = require(\"crypto\");","import { Module } from '@nestjs/common';\nimport { GeminiController } from './gemini.controller';\nimport { GeminiService } from './gemini.service';\nimport { ConfigModule } from '@nestjs/config';\n\n@Module({\n    imports: [ConfigModule],\n    controllers: [GeminiController],\n    providers: [GeminiService],\n    exports: [GeminiService],\n})\nexport class GeminiModule { }\n","import { Controller, Post, Body, UseGuards } from '@nestjs/common';\nimport { GeminiService } from './gemini.service';\nimport { TelegramAuthGuard } from '../auth/telegram-auth.guard';\n\n@Controller('chat')\nexport class GeminiController {\n    constructor(private readonly geminiService: GeminiService) { }\n\n    @Post()\n    // @UseGuards(TelegramAuthGuard) // Optional: Enable if you want to restrict to TWA users\n    async chat(@Body() body: { message: string }) {\n        const response = await this.geminiService.chat(body.message);\n        return { response };\n    }\n}\n","import { Injectable, OnModuleInit } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\nimport { GoogleGenerativeAI, Content, GenerativeModel } from '@google/generative-ai';\nimport axios from 'axios';\nimport * as mammoth from 'mammoth';\nimport * as path from 'path';\nimport * as fs from 'fs';\n\n@Injectable()\nexport class GeminiService implements OnModuleInit {\n    private genAI: GoogleGenerativeAI;\n    private model!: GenerativeModel;\n    private context = '';\n\n    constructor(private configService: ConfigService) {\n        const apiKey = this.configService.get<string>('GEMINI_API_KEY') || 'YOUR_API_KEY_HERE';\n        this.genAI = new GoogleGenerativeAI(apiKey);\n    }\n\n    async onModuleInit() {\n        await this.loadContext();\n        console.log('✅ База знаний успешно загружена из OneDrive');\n        \n        this.model = await this.genAI.getGenerativeModel({\n            model: 'gemini-2.5-flash',\n            systemInstruction: this.buildSystemPrompt()\n        });\n    }\n\n    private buildSystemPrompt(): string {\n        return `\n        You are a professional consultant for the AAA Cosmetics Clinic in Dushanbe.\n        \n        KNOWLEDGE BASE:\n        ${this.context}\n        \n        INSTRUCTIONS:\n        1. Answer in the user's language (Russian, Tajik, or English).\n        2. ALWAYS provide prices in TJS (Somoni).\n        3. Be polite, professional, and concise.\n        4. If you don't know the answer based on the knowledge base, ask the user to contact the clinic directly.\n        5. Answer the questions depends on User Personal Information.\n        6. FORMATTING RULES:\n            - Use HTML for all responses.\n            - Set style for every tag with inline styles (do not use CSS classes, do not use external CSS files). \n            - Approved inline styles: margin(min: 5px, max: 20px), background-color, color, font-weight, font-family.\n            - Use <strong>bold text</strong> for prices and service names.\n            - Use <table> for tables of services or preparation steps.\n            - Use <img> for images of services or preparation steps. max width/height 200px\n            - Use <ul><li>bullet points</li></ul> for lists of services or preparation steps. set margin between bullet points 10px\n            - Use <h3>Headings</h3> to separate different topics.\n            - Keep <p>paragraphs short (maximum 2-3 sentences)</p>\n            - Use <hr> horizontal rules to separate sections if the answer is long.\n        \n        `;\n    }\n\n\nprivate async loadContext() {\n  try {\n    const docPath = path.join(__dirname, 'assets', 'chat-bot.docx');\n    const result = await mammoth.extractRawText({ path: docPath });\n    \n    this.context = result.value;\n    console.log('✅ База знаний успешно загружена из OneDrive');\n\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : String(error);\n    console.error('❌ Ошибка загрузки контекста из OneDrive:', errorMsg);\n    this.context = 'AAA Cosmetics Clinic services and information.';\n  }\n}\n\n    async chat(message: string): Promise<string> {\n        return await this.chatWithHistory([{ role: 'user', parts: [{ text: message }] }]);\n    }\n\n    async chatWithHistory(history: Content[]): Promise<string> {\n        try {\n            const lastMsg = history[history.length - 1];\n\n            const chat = this.model.startChat({\n                history: history.slice(0, -1),\n            });\n\n            const text = lastMsg.parts[0].text || '';\n            const result = await chat.sendMessage(text);\n            const response = await result.response;\n            return response.text();\n        } catch (error) {\n            console.error('Gemini API Error:', JSON.stringify(error, null, 2));\n            if (error instanceof Error) {\n                console.error('Error message:', error.message);\n            }\n            return 'Извините, в данный момент я не могу ответить. Пожалуйста, попробуйте позже.';\n        }\n    }\n}\n","module.exports = require(\"@google/generative-ai\");","module.exports = require(\"mammoth\");","module.exports = require(\"path\");","import { Module } from '@nestjs/common';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { ChatController } from './chat.controller';\nimport { ChatService } from './chat.service';\nimport { Chat, ChatSchema } from './schemas/chat.schema';\nimport { GeminiModule } from '../gemini/gemini.module';\nimport { ConfigModule } from '@nestjs/config';\n\n@Module({\n    imports: [\n        MongooseModule.forFeature([{ name: Chat.name, schema: ChatSchema }]),\n        GeminiModule,\n        ConfigModule\n    ],\n    controllers: [ChatController],\n    providers: [ChatService],\n    exports: [ChatService],\n})\nexport class ChatModule { }\n","import { Controller, Post, Body } from '@nestjs/common';\nimport { ChatService } from './chat.service';\nimport { SendMessageDto } from './dto/send-message.dto';\n\n@Controller('chat')\nexport class ChatController {\n    constructor(private readonly chatService: ChatService) { }\n\n    @Post('message')\n    // @UseGuards(TelegramAuthGuard)\n    async sendMessage(@Body() body: SendMessageDto) {\n        console.log('Hello!', body);\n\n        return {\n            response: await this.chatService.handleMessage(body.chatId, body.message)\n        };\n    }\n}\n","import { Injectable, Logger } from '@nestjs/common';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { Model } from 'mongoose';\nimport { Chat, ChatDocument } from './schemas/chat.schema';\nimport { GeminiService } from '../gemini/gemini.service';\n\n@Injectable()\nexport class ChatService {\n    private readonly logger = new Logger(ChatService.name);\n\n    constructor(\n        @InjectModel(Chat.name) private chatModel: Model<ChatDocument>,\n        private geminiService: GeminiService\n    ) { }\n\n    async handleMessage(chatId: string, message: string): Promise<string> {\n        let chat = await this.chatModel.findOne({ chatId });\n        if (!chat) {\n            chat = new this.chatModel({ chatId, history: [] });\n        }\n\n        chat.history.push({ role: 'user', text: message, timestamp: new Date() });\n\n        // Limit history to last 50 messages to save context and tokens\n        const MAX_HISTORY = 50;\n        const recentHistory = chat.history.slice(-MAX_HISTORY);\n\n        const historyForAi = recentHistory.map(msg => ({\n            role: msg.role === 'user' ? 'user' : 'model',\n            parts: [{ text: msg.text }]\n        }));\n\n        const responseText = await this.geminiService.chatWithHistory(historyForAi);\n\n        chat.history.push({ role: 'model', text: responseText, timestamp: new Date() });\n        await chat.save();\n\n        return responseText;\n    }\n}\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document } from 'mongoose';\n\nexport type ChatDocument = Chat & Document;\n\n@Schema()\nexport class Message {\n    @Prop({ required: true, enum: ['user', 'model'] })\n    role!: string;\n\n    @Prop({ required: true })\n    text!: string;\n\n    @Prop({ default: Date.now })\n    timestamp!: Date;\n}\n\nexport const MessageSchema = SchemaFactory.createForClass(Message);\n\n@Schema({ timestamps: true })\nexport class Chat {\n    @Prop({ required: true, unique: true })\n    chatId!: string; // Telegram Chat ID or User ID\n\n    @Prop({ type: [MessageSchema], default: [] })\n    history!: Message[];\n}\n\nexport const ChatSchema = SchemaFactory.createForClass(Chat);\n","import { IsNotEmpty, IsString } from 'class-validator';\n\nexport class SendMessageDto {\n  @IsString()\n  @IsNotEmpty()\n  message!: string;\n\n  @IsString()\n  @IsNotEmpty()\n  chatId!: string;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * This is not a production server yet!\n * This is only a minimal backend to get started.\n */\n\nimport { Logger, ValidationPipe } from '@nestjs/common';\nimport { NestFactory } from '@nestjs/core';\nimport { AppModule } from './app/app.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  app.useGlobalPipes(new ValidationPipe({ whitelist: true }));\n  const port = process.env.PORT || 3000;\n  // app.setGlobalPrefix('api');\n  // app.enableCors({\n  //   // Разрешаем запросы только с твоего фронтенда на GitHub Pages\n  //   origin: [\n  //     'https://beginwebdev2002.github.io/',\n  //     /\\.github\\.io$/,\n  //     'http://localhost:4200' // Твой купленный домен\n  //   ],\n  //   methods: 'GET,HEAD,PUT,PATCH,POST,DELETE',\n  //   allowedHeaders: 'Content-Type, Accept, Authorization, x-telegram-init-data',\n  //   credentials: true,\n  // });\n  app.enableCors({\n    origin: true, // Разрешает запросы с любого источника (GitHub, Localhost)\n    methods: 'GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS',\n    credentials: true,\n    allowedHeaders: '*', // Принимает любые заголовки, включая Telegram Init Data\n    maxAge: 3600,\n  });\n  await app.listen(port);\n  Logger.log(\n    `🚀 Application is running on: http://localhost:${port}`,\n  );\n}\n\nbootstrap();\n"],"names":[],"ignoreList":[],"sourceRoot":""}