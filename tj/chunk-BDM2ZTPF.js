import{a as V,b as U,c as j,d as z}from"./chunk-ZAAYPVNZ.js";import{a as X}from"./chunk-PMER4QEK.js";import{a as $,b as B}from"./chunk-OPDYVSBD.js";import{b as G}from"./chunk-M7GE5IHF.js";import{Gb as R,Ha as x,Hb as k,I as T,Ib as F,Jb as W,La as h,M as f,N as E,S as m,T as c,U as M,Ua as d,Va as a,Wa as r,Xa as l,Ya as y,Za as b,_a as C,bb as S,cb as P,da as _,db as N,eb as w,fb as g,hb as v,ib as I,jb as D,kb as O,mb as L,nb as H,ua as s}from"./chunk-MXMKHO7C.js";var u=class o{constructor(i,e){this.http=i;this.configService=e;}sendMessage(i,e="guest"){let t=this.configService.get("BACKEND_URL_ONLINE")+"/chat/message",n=new $();return typeof Telegram<"u"&&Telegram.WebApp&&Telegram.WebApp.initData&&(n=n.set("x-telegram-init-data",Telegram.WebApp.initData)),this.http.post(t,{message:i,chatId:e},{headers:n});}static ɵfac=function(e){return new(e||o)(f(B),f(X));};static ɵprov=T({token:o,factory:o.ɵfac,providedIn:"root"});};var q=["scrollContainer"];function K(o,i){o&1&&l(0,"div",26);}function J(o,i){o&1&&l(0,"div",27);}function Z(o,i){if(o&1&&(a(0,"div",21)(1,"div",22),h(2,K,1,0,"div",23)(3,J,1,0,"div",24),g(4),r(),a(5,"span",25),g(6),L(7,"date"),r()()),o&2){let e=i.$implicit;w("items-end",e.role==="user")("items-start",e.role==="bot"),s(),w("bg-gradient-to-br",e.role==="user")("from-rose-500",e.role==="user")("to-rose-600",e.role==="user")("text-white",e.role==="user")("rounded-br-none",e.role==="user")("bg-white",e.role==="bot")("text-gray-700",e.role==="bot")("border",e.role==="bot")("border-rose-100",e.role==="bot")("rounded-bl-none",e.role==="bot")("shadow-sm",e.role==="bot"),s(),d("ngIf",e.role==="bot"),s(),d("ngIf",e.role==="user"),s(),v(" ",e.text," "),s(2),v(" ",H(7,30,e.time,"HH:mm")," ");}}function ee(o,i){o&1&&(a(0,"div",28),l(1,"div",29)(2,"div",30)(3,"div",31),r());}var Q=class o{scrollContainer;messages=_([{role:"bot",text:"\u0421\u0430\u043B\u043E\u043C! \u041C\u0430\u043D \u043C\u0443\u0448\u043E\u0432\u0438\u0440\u0438 \u0448\u0430\u0445\u0441\u0438\u0438 \u0448\u0443\u043C\u043E \u0434\u0430\u0440 \u043A\u043B\u0438\u043D\u0438\u043A\u0430\u0438 AAA Cosmetics \u04B3\u0430\u0441\u0442\u0430\u043C. \u0418\u043C\u0440\u04EF\u0437 \u0447\u04E3 \u0433\u0443\u043D\u0430 \u043C\u0435\u0442\u0430\u0432\u043E\u043D\u0430\u043C \u0431\u0430 \u0448\u0443\u043C\u043E \u043A\u04EF\u043C\u0430\u043A \u0440\u0430\u0441\u043E\u043D\u0430\u043C?",time:new Date()}]);newMessage="";isLoading=_(!1);chatService=E(u);ngOnInit(){this.scrollToBottom();}ngAfterViewChecked(){this.scrollToBottom();}scrollToBottom(){try{this.scrollContainer.nativeElement.scrollTop=this.scrollContainer.nativeElement.scrollHeight;}catch{}}onEnter(i){i.preventDefault(),this.sendMessage();}sendMessage(){if(!this.newMessage.trim()||this.isLoading())return;let i=this.newMessage.trim();this.messages.update(t=>[...t,{role:"user",text:i,time:new Date()}]),this.newMessage="",this.isLoading.set(!0),typeof Telegram<"u"&&Telegram.WebApp&&Telegram.WebApp.HapticFeedback.impactOccurred("light");let e="guest";typeof Telegram<"u"&&Telegram.WebApp&&Telegram.WebApp.initDataUnsafe?.user?.id&&(e=Telegram.WebApp.initDataUnsafe.user.id.toString()),this.chatService.sendMessage(i,e).subscribe({next:t=>{this.messages.update(n=>[...n,{role:"bot",text:t.response,time:new Date()}]),this.isLoading.set(!1),typeof Telegram<"u"&&Telegram.WebApp&&Telegram.WebApp.HapticFeedback.notificationOccurred("success");},error:()=>{this.messages.update(t=>[...t,{role:"bot",text:"\u041C\u0435\u0431\u0430\u0445\u0448\u0435\u0434, \u0445\u0430\u0442\u043E\u0433\u04E3 \u0440\u0443\u0445 \u0434\u043E\u0434. \u041B\u0443\u0442\u0444\u0430\u043D \u0434\u0435\u0440\u0442\u0430\u0440 \u043A\u04EF\u0448\u0438\u0448 \u043A\u0443\u043D\u0435\u0434.",time:new Date()}]),this.isLoading.set(!1),typeof Telegram<"u"&&Telegram.WebApp&&Telegram.WebApp.HapticFeedback.notificationOccurred("error");}});}static ɵfac=function(e){return new(e||o)();};static ɵcmp=x({type:o,selectors:[["app-chat"]],viewQuery:function(e,t){if(e&1&&S(q,5),e&2){let n;P(n=N())&&(t.scrollContainer=n.first);}},decls:24,vars:4,consts:()=>{let i;i="\u0414\u0430\u0440 \u0431\u043E\u0440\u0430\u0438 \u0440\u0430\u0441\u043C\u0438\u0451\u0442 \u0441\u0430\u0432\u043E\u043B \u0434\u0438\u04B3\u0435\u0434...";let e;e="AI \u041C\u0443\u0448\u043E\u0432\u0438\u0440";let t;return t="\u041E\u043D\u043B\u0430\u0439\u043D 24/7",[["scrollContainer",""],e,t,[1,"flex","flex-col","h-screen","bg-gradient-to-b","from-rose-50","to-white"],[1,"bg-white/80","backdrop-blur-md","p-4","shadow-sm","flex","items-center","justify-between","sticky","top-0","z-10","border-b","border-rose-100"],[1,"flex","items-center"],[1,"relative"],[1,"w-12","h-12","rounded-full","bg-gradient-to-tr","from-rose-200","to-rose-100","flex","items-center","justify-center","mr-3","shadow-inner","border","border-white"],[1,"text-2xl"],[1,"absolute","bottom-0","right-3","w-3","h-3","bg-green-500","border-2","border-white","rounded-full"],[1,"font-serif","text-lg","text-gray-800","font-medium","tracking-wide"],[1,"text-xs","text-rose-400","font-medium"],[1,"flex-1","overflow-y-auto","p-4","space-y-6","scroll-smooth"],["class","flex flex-col animate-fade-in-up",3,"items-end","items-start",4,"ngFor","ngForOf"],["class","flex items-center space-x-1.5 ml-2 p-3 bg-white rounded-2xl rounded-bl-none border border-rose-100 w-fit shadow-sm",4,"ngIf"],[1,"p-3","bg-white","border-t","border-rose-100","pb-safe"],[1,"flex","gap-2","items-end","bg-gray-50","p-1.5","rounded-[24px]","border","border-gray-200","focus-within:border-rose-300","focus-within:ring-2","focus-within:ring-rose-100","transition-all"],["rows","1","placeholder",i,1,"flex-1","bg-transparent","border-0","rounded-xl","px-4","py-3","focus:ring-0","text-gray-700","placeholder-gray-400","resize-none","max-h-32","min-h-[44px]",3,"ngModelChange","keydown.enter","ngModel"],[1,"bg-rose-500","text-white","w-10","h-10","rounded-full","flex","items-center","justify-center","hover:bg-rose-600","disabled:opacity-50","disabled:hover:bg-rose-500","transition-all","shadow-md","active:scale-95","mb-0.5","mr-0.5",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","ml-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"],[1,"flex","flex-col","animate-fade-in-up"],[1,"max-w-[85%]","p-4","rounded-2xl","text-[15px]","leading-relaxed","relative","group"],["class","absolute -left-2 top-0 w-2 h-2 bg-white border-t border-l border-rose-100 [clip-path:polygon(100%_0,0_0,100%_100%)]",4,"ngIf"],["class","absolute -right-2 top-0 w-2 h-2 bg-rose-500 [clip-path:polygon(0_0,100%_0,0_100%)]",4,"ngIf"],[1,"text-[10px]","text-gray-400","mt-1.5","px-1","font-medium","select-none"],[1,"absolute","-left-2","top-0","w-2","h-2","bg-white","border-t","border-l","border-rose-100","[clip-path:polygon(100%_0,0_0,100%_100%)]"],[1,"absolute","-right-2","top-0","w-2","h-2","bg-rose-500","[clip-path:polygon(0_0,100%_0,0_100%)]"],[1,"flex","items-center","space-x-1.5","ml-2","p-3","bg-white","rounded-2xl","rounded-bl-none","border","border-rose-100","w-fit","shadow-sm"],[1,"w-2","h-2","bg-rose-300","rounded-full","animate-bounce"],[1,"w-2","h-2","bg-rose-300","rounded-full","animate-bounce","delay-75"],[1,"w-2","h-2","bg-rose-300","rounded-full","animate-bounce","delay-150"]];},template:function(e,t){if(e&1){let n=y();a(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"span",8),g(6,"\u{1F469}\u200D\u2695\uFE0F"),r()(),l(7,"div",9),r(),a(8,"div")(9,"h1",10),b(10,1),r(),a(11,"p",11),b(12,2),r()()(),l(13,"app-language-switcher"),r(),a(14,"div",12,0),h(16,Z,8,33,"div",13)(17,ee,4,0,"div",14),r(),a(18,"div",15)(19,"div",16)(20,"textarea",17),O("ngModelChange",function(p){return m(n),D(t.newMessage,p)||(t.newMessage=p),c(p);}),C("keydown.enter",function(p){return m(n),c(t.onEnter(p));}),r(),a(21,"button",18),C("click",function(){return m(n),c(t.sendMessage());}),M(),a(22,"svg",19),l(23,"path",20),r()()()()();}e&2&&(s(16),d("ngForOf",t.messages()),s(),d("ngIf",t.isLoading()),s(3),I("ngModel",t.newMessage),s(),d("disabled",!t.newMessage.trim()||t.isLoading()));},dependencies:[W,R,k,z,V,U,j,G,F],styles:[".pb-safe[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom,16px)}.animate-fade-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]});};export{Q as ChatComponent};/**i18n:019b463f0eded3266b87e66c13ed070ae77feb59761ca3051e0f3fc2e0fe79aa*/